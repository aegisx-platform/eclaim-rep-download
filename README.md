# E-Claim Downloader & Data Import System

> ‡∏£‡∏∞‡∏ö‡∏ö download ‡πÅ‡∏•‡∏∞ import ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• e-claim ‡∏à‡∏≤‡∏Å NHSO ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ ‡∏û‡∏£‡πâ‡∏≠‡∏° Web UI ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏•‡∏∞‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•

![Dashboard](screenshots/dashboard.jpeg)

---

## ‚òï Support This Project

If you find this project helpful, consider buying me a coffee!

<a href="https://www.buymeacoffee.com/sathit" target="_blank"><img src="https://cdn.buymeacoffee.com/buttons/v2/default-yellow.png" alt="Buy Me A Coffee" style="height: 60px !important;width: 217px !important;" ></a>

**Developer:** Sathit Seethaphon | [aegisx platform](https://github.com/aegisx-platform)

---

## ‚ú® Features

### üåê Web UI Dashboard
- ‚úÖ **Dashboard** - ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà download ‡∏û‡∏£‡πâ‡∏≠‡∏° charts
- ‚úÖ **Files Management** - ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÑ‡∏ü‡∏•‡πå (view, download, delete)
- ‚úÖ **Pagination** - ‡πÅ‡∏™‡∏î‡∏á 50 ‡πÑ‡∏ü‡∏•‡πå‡∏ï‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤ ‡∏û‡∏£‡πâ‡∏≠‡∏° smart navigation
- ‚úÖ **Month/Year Filter** - ‡∏Å‡∏£‡∏≠‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏ï‡∏≤‡∏°‡πÄ‡∏î‡∏∑‡∏≠‡∏ô/‡∏õ‡∏µ (default: ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô)
- ‚úÖ **Import Status** - ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ imported/pending ‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÑ‡∏ü‡∏•‡πå
- ‚úÖ **Import All** - import ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ó‡∏µ‡πà pending ‡πÑ‡∏î‡πâ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß
- ‚úÖ **Clear All Data** - ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (with triple confirmation)
- ‚úÖ **Settings Page** - ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ username/password ‡∏à‡∏≤‡∏Å UI
- ‚úÖ **Real-time Log Viewer** - ‡∏î‡∏π download/import progress ‡πÅ‡∏ö‡∏ö real-time

### üì• Download System
- ‚úÖ **Auto Login** - ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö e-claim ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
- ‚úÖ **HTTP Client** - ‡πÉ‡∏ä‡πâ requests library (‡πÄ‡∏£‡πá‡∏ß ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡∏¥‡∏î browser)
- ‚úÖ **Single Month Download** - download ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô/‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
- ‚úÖ **Bulk Download** - download ‡∏´‡∏•‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ô (sequential processing)
- ‚úÖ **Date Range Selection** - ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤ start/end date
- ‚úÖ **Auto-Import Toggle** - ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡πà‡∏≤‡∏à‡∏∞ import ‡∏´‡∏•‡∏±‡∏á download ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
- ‚úÖ **Duplicate Prevention** - ‡πÑ‡∏°‡πà download ‡∏ã‡πâ‡∏≥ (check history)
- ‚úÖ **Progress Tracking** - ‡πÅ‡∏™‡∏î‡∏á progress bar ‡πÅ‡∏ö‡∏ö real-time
- ‚úÖ **Download History** - ‡πÄ‡∏Å‡πá‡∏ö‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£ download ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î

### ‚è∞ Automated Scheduling
- ‚úÖ **Multiple Schedules** - ‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏ß‡∏•‡∏≤ download ‡πÑ‡∏î‡πâ‡∏´‡∏•‡∏≤‡∏¢‡∏ä‡πà‡∏ß‡∏á‡∏ï‡πà‡∏≠‡∏ß‡∏±‡∏ô (‡πÄ‡∏ä‡πà‡∏ô 09:00, 14:00, 20:00)
- ‚úÖ **Enable/Disable Toggle** - ‡πÄ‡∏õ‡∏¥‡∏î/‡∏õ‡∏¥‡∏î scheduler ‡∏à‡∏≤‡∏Å Web UI
- ‚úÖ **Auto-Import Option** - ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÉ‡∏´‡πâ import ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏´‡∏•‡∏±‡∏á scheduled download
- ‚úÖ **Schedule Status Display** - ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ scheduler ‡∏ö‡∏ô Dashboard ‡πÅ‡∏•‡∏∞ Files page
- ‚úÖ **Next Run Time** - ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏à‡∏∞ download ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ñ‡∏±‡∏î‡πÑ‡∏õ
- ‚úÖ **Test Run** - ‡∏ó‡∏î‡∏™‡∏≠‡∏ö download ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏≠‡∏ñ‡∏∂‡∏á‡πÄ‡∏ß‡∏•‡∏≤
- ‚úÖ **Background Execution** - ‡∏£‡∏±‡∏ô‡πÉ‡∏ô background ‡πÑ‡∏°‡πà‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
- ‚úÖ **Persistent Settings** - ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÉ‡∏ô config/settings.json

### üíæ Database Import System
- ‚úÖ **Multi-Database Support** - ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö PostgreSQL ‡πÅ‡∏•‡∏∞ MySQL
- ‚úÖ **All File Types** - OP, IP, ORF, IP_APPEAL, IP_APPEAL_NHSO
- ‚úÖ **Smart Header Detection** - ‡∏´‡∏≤ header row ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
- ‚úÖ **Column Auto-Mapping** - map columns ‡∏ï‡∏≤‡∏° field names
- ‚úÖ **Date Conversion** - ‡πÅ‡∏õ‡∏•‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏ó‡∏¢ (BE) ‡πÄ‡∏õ‡πá‡∏ô Gregorian (AD)
- ‚úÖ **UPSERT Logic** - ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô duplicate records
- ‚úÖ **Concurrent Import** - import ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡∏´‡∏•‡∏±‡∏á download ‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÑ‡∏ü‡∏•‡πå
- ‚úÖ **Import Tracking** - track ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£ import ‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÑ‡∏ü‡∏•‡πå
- ‚úÖ **HIS Reconciliation Fields** - fields ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö reconcile ‡∏Å‡∏±‡∏ö‡∏£‡∏∞‡∏ö‡∏ö HIS
- ‚úÖ **CLI Tool** - import ‡∏à‡∏≤‡∏Å command line ‡πÑ‡∏î‡πâ

### üê≥ Docker Deployment
- ‚úÖ **Two Deployment Modes:**
  - `docker-compose.yml` - Full stack (Web + PostgreSQL + pgAdmin)
  - `docker-compose-no-db.yml` - Download only (‡πÑ‡∏°‡πà‡∏°‡∏µ database)
- ‚úÖ **Optimized Dockerfile** - Python 3.12 with multi-stage builds
- ‚úÖ **Health Checks** - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ services ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
- ‚úÖ **Auto-Restart** - restart service ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤
- ‚úÖ **Volume Persistence** - ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ñ‡∏≤‡∏ß‡∏£ (downloads, logs, database)
- ‚úÖ **Environment Configuration** - ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ú‡πà‡∏≤‡∏ô .env file
- ‚úÖ **Timezone Support** - Bangkok timezone (GMT+7)
- ‚úÖ **One-Command Deploy** - `docker-compose up -d`

---

## üöÄ Quick Start

### Docker Deployment (‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥)

#### ‡πÅ‡∏ö‡∏ö‡∏ó‡∏µ‡πà 1: Full Stack (‡∏°‡∏µ Database) üè•

‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á‡πÉ‡∏ô‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏• ‡∏°‡∏µ‡∏ó‡∏±‡πâ‡∏á download ‡πÅ‡∏•‡∏∞ import ‡πÄ‡∏Ç‡πâ‡∏≤ database

```bash
# 1. Clone repository
git clone https://github.com/aegisx-platform/eclaim-req-download.git
cd eclaim-req-download

# 2. Setup environment
cp .env.example .env
nano .env  # ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç ECLAIM_USERNAME ‡πÅ‡∏•‡∏∞ ECLAIM_PASSWORD

# 3. Start all services
docker-compose up -d

# 4. Check logs
docker-compose logs -f
```

**‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô:**
- üåê **Web UI**: http://localhost:5001
- üóÑÔ∏è **Database**: postgresql://eclaim:eclaim_password@localhost:5432/eclaim_db
- üîß **pgAdmin**: http://localhost:5050 (admin@eclaim.local / admin)

#### ‡πÅ‡∏ö‡∏ö‡∏ó‡∏µ‡πà 2: Download Only (‡πÑ‡∏°‡πà‡∏°‡∏µ Database) üì•

‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö download ‡πÑ‡∏ü‡∏•‡πå‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ import ‡πÄ‡∏Ç‡πâ‡∏≤ database

```bash
# 1-2. ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÅ‡∏ö‡∏ö‡∏ó‡∏µ‡πà 1

# 3. Start web service only
docker-compose -f docker-compose-no-db.yml up -d

# 4. Check logs
docker-compose -f docker-compose-no-db.yml logs -f
```

**‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô:**
- üåê **Web UI**: http://localhost:5001

### Manual Installation (Without Docker)

<details>
<summary>‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏ß‡∏¥‡∏ò‡∏µ install ‡πÅ‡∏ö‡∏ö manual</summary>

**Prerequisites:**
- Python 3.12+
- PostgreSQL 13+ (optional)

**Installation:**

```bash
# 1. Clone repository
git clone https://github.com/aegisx-platform/eclaim-req-download.git
cd eclaim-req-download

# 2. Create virtual environment
python3.12 -m venv venv
source venv/bin/activate  # On Windows: venv\Scripts\activate

# 3. Install dependencies
pip install -r requirements.txt

# 4. Configure credentials
cp .env.example .env
nano .env  # Update credentials

# 5. (Optional) Setup database
createdb eclaim_db
psql -U postgres -d eclaim_db -f database/schema.sql

# 6. Run Flask app
python app.py
```

**Access:** http://localhost:5001

</details>

---

## üì± Web UI Guide

### 1. Dashboard Page
- ‡∏î‡∏π‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Å‡∏≤‡∏£ download (Total files, size, last run, file types)
- ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ **Auto Download Schedule** (Active/Inactive)
- ‡πÅ‡∏™‡∏î‡∏á **Next Download Time** ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡∏¥‡∏î scheduler
- ‡∏î‡∏π‡πÑ‡∏ü‡∏•‡πå‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î 5 ‡πÑ‡∏ü‡∏•‡πå

### 2. Files Page
- ‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (pagination 50 ‡∏ï‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤)
- ‡∏Å‡∏£‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡πÄ‡∏î‡∏∑‡∏≠‡∏ô/‡∏õ‡∏µ (default: ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô)
- ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ import (Imported/Pending)
- Download ‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÑ‡∏ü‡∏•‡πå
- Import file ‡πÄ‡∏î‡∏µ‡πà‡∏¢‡∏ß ‡∏´‡∏£‡∏∑‡∏≠ Import All
- Delete ‡πÑ‡∏ü‡∏•‡πå

### 3. Date Range Page
- **Single Month Download** - ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å month/year ‡πÅ‡∏•‡∏∞ download
- **Bulk Download** - ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤ start/end ‡πÅ‡∏•‡πâ‡∏ß download ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
- **Auto-Import Checkbox** - ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡πà‡∏≤‡∏à‡∏∞ import ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
- ‡∏î‡∏π estimated time

### 4. Settings Page
- **E-Claim Credentials** - ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ username/password
- **Auto Download Schedule:**
  - Add/Remove scheduled times
  - Enable/Disable scheduler
  - Auto-import toggle ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö scheduled downloads
  - ‡∏î‡∏π‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ scheduled jobs
  - Test Run Now button

---

## ‚è∞ Using Auto Download Schedule

### ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Scheduler

1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà **Settings** page
2. ‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏•‡∏á‡πÑ‡∏õ‡∏™‡πà‡∏ß‡∏ô "Auto Download Schedule"
3. ‡∏Å‡∏î **"Add Schedule"** ‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏ß‡∏•‡∏≤ (‡πÄ‡∏ä‡πà‡∏ô 09:00)
4. ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ß‡∏•‡∏≤‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡πÑ‡∏î‡πâ (‡πÄ‡∏ä‡πà‡∏ô 14:00, 20:00)
5. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å **"Auto-import files after download"** ‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
6. ‡πÄ‡∏õ‡∏¥‡∏î **"Enable Schedule"** toggle
7. ‡∏Å‡∏î **"Save Schedule"**

**‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á:** ‡∏ï‡∏±‡πâ‡∏á‡πÉ‡∏´‡πâ download ‡∏ß‡∏±‡∏ô‡∏•‡∏∞ 2 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á
- 09:00 ‡∏ô. - download ‡πÄ‡∏ä‡πâ‡∏≤
- 20:00 ‡∏ô. - download ‡πÄ‡∏¢‡πá‡∏ô

### ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞

- **Dashboard Page** - ‡∏î‡∏π‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ scheduler ‡πÅ‡∏•‡∏∞ next run time
- **Files Page** - ‡πÅ‡∏™‡∏î‡∏á banner ‡∏ö‡∏≠‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ scheduler
- **Settings Page** - ‡∏î‡∏π scheduled jobs ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î

---

## üîß Configuration

### Settings File (config/settings.json)

‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏ä‡πâ‡πÑ‡∏ü‡∏•‡πå `config/settings.json` ‡πÄ‡∏Å‡πá‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ (‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ú‡πà‡∏≤‡∏ô Web UI ‡πÑ‡∏î‡πâ):

```json
{
  "eclaim_username": "your_username",
  "eclaim_password": "your_password",
  "download_dir": "downloads",
  "auto_import_default": false,
  "schedule_enabled": true,
  "schedule_times": [
    {"hour": 9, "minute": 0},
    {"hour": 20, "minute": 0}
  ],
  "schedule_auto_import": true
}
```

### Environment Variables

| Variable | Default | Description |
|----------|---------|-------------|
| `ECLAIM_USERNAME` | - | E-Claim login username |
| `ECLAIM_PASSWORD` | - | E-Claim login password |
| `DB_TYPE` | postgresql | Database type (postgresql/mysql/none) |
| `DB_HOST` | db | Database host |
| `DB_PORT` | 5432 | Database port |
| `DB_NAME` | eclaim_db | Database name |
| `DB_USER` | eclaim | Database user |
| `DB_PASSWORD` | eclaim_password | Database password |
| `TZ` | Asia/Bangkok | Timezone |
| `FLASK_ENV` | production | Flask environment |

**Priority:** `config/settings.json` > Environment Variables

---

## üìÅ Project Structure

```
eclaim-req-download/
‚îú‚îÄ‚îÄ app.py                          # Flask web application
‚îú‚îÄ‚îÄ eclaim_downloader_http.py       # HTTP Client downloader
‚îú‚îÄ‚îÄ bulk_downloader.py              # Bulk download orchestrator
‚îú‚îÄ‚îÄ download_with_import.py         # Download wrapper with import
‚îú‚îÄ‚îÄ eclaim_import.py                # CLI import tool
‚îú‚îÄ‚îÄ Dockerfile                      # Docker image definition
‚îú‚îÄ‚îÄ docker-compose.yml              # Full stack deployment
‚îú‚îÄ‚îÄ docker-compose-no-db.yml        # Download-only deployment
‚îú‚îÄ‚îÄ .env.example                    # Environment template
‚îú‚îÄ‚îÄ .dockerignore                   # Docker build optimization
‚îú‚îÄ‚îÄ requirements.txt                # Python dependencies
‚îÇ
‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îú‚îÄ‚îÄ database.py                 # Database configuration
‚îÇ   ‚îú‚îÄ‚îÄ settings.json.example       # Settings template
‚îÇ   ‚îî‚îÄ‚îÄ settings.json               # User settings (gitignored)
‚îÇ
‚îú‚îÄ‚îÄ database/
‚îÇ   ‚îú‚îÄ‚îÄ schema.sql                  # PostgreSQL schema
‚îÇ   ‚îî‚îÄ‚îÄ IMPORT_GUIDE.md             # Import documentation
‚îÇ
‚îú‚îÄ‚îÄ utils/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ history_manager.py          # Download history CRUD
‚îÇ   ‚îú‚îÄ‚îÄ file_manager.py             # Safe file operations
‚îÇ   ‚îú‚îÄ‚îÄ downloader_runner.py        # Background process management
‚îÇ   ‚îú‚îÄ‚îÄ import_runner.py            # Import process management
‚îÇ   ‚îú‚îÄ‚îÄ log_stream.py               # Real-time log streaming (SSE)
‚îÇ   ‚îú‚îÄ‚îÄ settings_manager.py         # Settings CRUD
‚îÇ   ‚îú‚îÄ‚îÄ scheduler.py                # APScheduler integration
‚îÇ   ‚îî‚îÄ‚îÄ eclaim/
‚îÇ       ‚îú‚îÄ‚îÄ parser.py               # XLS file parser
‚îÇ       ‚îî‚îÄ‚îÄ importer.py             # Database importer
‚îÇ
‚îú‚îÄ‚îÄ templates/                      # Jinja2 HTML templates
‚îÇ   ‚îú‚îÄ‚îÄ base.html                   # Base template with navbar
‚îÇ   ‚îú‚îÄ‚îÄ dashboard.html              # Dashboard with stats
‚îÇ   ‚îú‚îÄ‚îÄ files.html                  # File list with pagination
‚îÇ   ‚îú‚îÄ‚îÄ download_config.html        # Date range selection
‚îÇ   ‚îú‚îÄ‚îÄ settings.html               # Settings configuration
‚îÇ   ‚îî‚îÄ‚îÄ components/
‚îÇ       ‚îî‚îÄ‚îÄ log_viewer.html         # Real-time log component
‚îÇ
‚îú‚îÄ‚îÄ static/                         # Static assets
‚îÇ   ‚îú‚îÄ‚îÄ js/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ app.js                  # Frontend JavaScript
‚îÇ   ‚îî‚îÄ‚îÄ css/
‚îÇ       ‚îî‚îÄ‚îÄ custom.css              # Custom styles
‚îÇ
‚îú‚îÄ‚îÄ downloads/                      # Downloaded Excel files
‚îú‚îÄ‚îÄ logs/                           # Application logs
‚îî‚îÄ‚îÄ backups/                        # Database backups
```

---

## üìä Database Schema

### Tables

1. **eclaim_imported_files**
   - Track import status ‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÑ‡∏ü‡∏•‡πå
   - Fields: file_id, filename, file_hash, imported_at, import_status

2. **eclaim_claims**
   - ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• claims ‡∏ó‡∏∏‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó (OP, IP, IP_APPEAL, IP_APPEAL_NHSO)
   - Fields: claim_id, claim_type, hn, pid, vn, admission_date, discharge_date, total_amount
   - HIS reconciliation fields: his_matched, his_vn, reconcile_status

3. **eclaim_op_refer**
   - ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• OP Refer (ORF)
   - Fields: refer_id, hn, pid, refer_date, refer_to_hcode

### HIS Reconciliation Fields

‡∏£‡∏∞‡∏ö‡∏ö‡∏°‡∏µ fields ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö reconcile ‡∏Å‡∏±‡∏ö‡∏£‡∏∞‡∏ö‡∏ö‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•:
- `his_matched` - ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£ match (boolean)
- `his_matched_at` - ‡∏ß‡∏±‡∏ô‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà match
- `his_vn` - Visit Number ‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö HIS
- `reconcile_status` - ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ (matched/unmatched/conflict)
- `reconcile_amount_diff` - ‡∏ú‡∏•‡∏ï‡πà‡∏≤‡∏á‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô (e-claim vs HIS)

‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°: [database/schema.sql](database/schema.sql)

---

## ‚öñÔ∏è Legal & Compliance

### ‚úÖ ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢

‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏ô‡∏µ‡πâ**‡πÑ‡∏°‡πà‡∏ú‡∏¥‡∏î‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢** ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡πÄ‡∏û‡∏£‡∏≤‡∏∞:

1. **‡πÉ‡∏ä‡πâ Credentials ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï**
   - ‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö username/password ‡∏à‡∏≤‡∏Å NHSO ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
   - ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£ hack ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï

2. **‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå**
   - ‡∏î‡∏∂‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡πÑ‡∏î‡πâ‡∏ú‡πà‡∏≤‡∏ô e-claim
   - ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£ bypass security ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏≠‡∏∑‡πà‡∏ô

3. **‡πÉ‡∏ä‡πâ‡∏ï‡∏≤‡∏°‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á**
   - ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏ö‡∏¥‡∏Å‡∏à‡πà‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡πÄ‡∏≠‡∏á
   - Reconcile ‡∏Å‡∏±‡∏ö‡∏£‡∏∞‡∏ö‡∏ö HIS
   - Audit ‡πÅ‡∏•‡∏∞ reporting

### ‚ö†Ô∏è ‡∏û.‡∏£.‡∏ö. ‡∏Ñ‡∏∏‡πâ‡∏°‡∏Ñ‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏• (PDPA)

‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• e-claim ‡∏°‡∏µ**‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢** (HN, CID, ‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•, ‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡∏ô‡∏¥‡∏à‡∏â‡∏±‡∏¢)

**‡∏Ç‡πâ‡∏≠‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á comply:**

1. **‡∏ê‡∏≤‡∏ô‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•**
   - ‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏°‡∏µ‡∏ê‡∏≤‡∏ô‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢ (‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏ï‡∏≤‡∏°‡∏™‡∏±‡∏ç‡∏ç‡∏≤, ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡∏≤‡∏°‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢)
   - ‡πÉ‡∏ä‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏• ‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏ö‡∏¥‡∏Å‡∏à‡πà‡∏≤‡∏¢

2. **‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏ô‡∏Ñ‡∏á‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢**
   - ‡∏ï‡∏±‡πâ‡∏á‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô database ‡∏ó‡∏µ‡πà‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏£‡∏á
   - ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡πÑ‡∏î‡πâ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ö‡∏∏‡∏Ñ‡∏•‡∏≤‡∏Å‡∏£‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï
   - ‡πÉ‡∏ä‡πâ VPN ‡∏´‡∏£‡∏∑‡∏≠ private network ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
   - **‡∏´‡πâ‡∏≤‡∏°‡πÄ‡∏õ‡∏¥‡∏î public internet ‡πÇ‡∏î‡∏¢‡πÄ‡∏î‡πá‡∏î‡∏Ç‡∏≤‡∏î**

3. **‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á (Access Control)**
   - ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ firewall ‡πÉ‡∏´‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡πÑ‡∏î‡πâ‡πÄ‡∏â‡∏û‡∏≤‡∏∞ IP ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•
   - ‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏° authentication (username/password login)
   - Audit logs ‡∏ó‡∏∏‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á

4. **‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡∏£‡∏±‡∏Å‡∏©‡∏≤‡πÅ‡∏•‡∏∞‡∏•‡∏ö‡∏ó‡∏¥‡πâ‡∏á**
   - ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏ó‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô (‡∏ï‡∏≤‡∏°‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö NHSO)
   - ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏´‡∏°‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô
   - Backup ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏´‡∏±‡∏™

5. **‡∏´‡πâ‡∏≤‡∏°‡πÅ‡∏ä‡∏£‡πå‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ú‡∏¢**
   - ‡∏´‡πâ‡∏≤‡∏°‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏≠‡∏Å‡∏ô‡∏≠‡∏Å‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•
   - ‡∏´‡πâ‡∏≤‡∏°‡πÅ‡∏ä‡∏£‡πå‡πÑ‡∏ü‡∏•‡πå‡∏ú‡πà‡∏≤‡∏ô cloud storage ‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏∞
   - ‡∏´‡πâ‡∏≤‡∏° export ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡πÑ‡∏õ‡πÉ‡∏ä‡πâ‡∏ô‡∏≠‡∏Å‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå

### ‚ùå ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°

**‡∏´‡πâ‡∏≤‡∏°** ‡πÉ‡∏ä‡πâ‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏ô‡∏µ‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠:
- ‚ùå ‡∏Ç‡∏≤‡∏¢‡∏´‡∏£‡∏∑‡∏≠‡πÅ‡∏ä‡∏£‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å
- ‚ùå ‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏≠‡∏Å‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå (‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î, ‡∏ß‡∏¥‡∏à‡∏±‡∏¢‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏¥‡∏ô‡∏¢‡∏≠‡∏°)
- ‚ùå ‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ú‡∏¢‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï
- ‚ùå Deploy ‡∏ö‡∏ô public cloud ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏°‡∏≤‡∏ï‡∏£‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢

### Disclaimer

```
‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏ô‡∏µ‡πâ‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ä‡πà‡∏ß‡∏¢‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• e-claim

‡∏ú‡∏π‡πâ‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÑ‡∏°‡πà‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö‡∏ï‡πà‡∏≠:
- ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢
- ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡∏¢‡∏´‡∏≤‡∏¢‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏£‡∏±‡πà‡∏ß‡πÑ‡∏´‡∏•‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
- ‡∏Å‡∏≤‡∏£‡∏•‡∏∞‡πÄ‡∏°‡∏¥‡∏î PDPA ‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡∏≠‡∏∑‡πà‡∏ô‡πÜ

‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö‡πÉ‡∏ô‡∏Å‡∏≤‡∏£:
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
- ‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏ï‡∏≤‡∏° PDPA ‡πÅ‡∏•‡∏∞‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á
- ‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢
```

---

## üîê Security Best Practices

### Production Deployment Checklist

- [ ] ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô default passwords ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
- [ ] ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ firewall ‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á
- [ ] ‡πÉ‡∏ä‡πâ VPN ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö remote access
- [ ] ‡πÄ‡∏õ‡∏¥‡∏î HTTPS (SSL/TLS certificate)
- [ ] ‡πÄ‡∏û‡∏¥‡πà‡∏° authentication ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Web UI
- [ ] ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏´‡∏±‡∏™ database backups
- [ ] ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ audit logging
- [ ] Monitor logs ‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥
- [ ] Update security patches ‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠

### Network Security

```bash
# Allow access only from hospital network
ufw allow from 192.168.1.0/24 to any port 5001

# Block all other access
ufw deny 5001
```

### Authentication (Recommended)

‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏°:
- Login system ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Web UI
- OAuth/LDAP integration ‡∏Å‡∏±‡∏ö‡∏£‡∏∞‡∏ö‡∏ö‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•
- Two-factor authentication (2FA)
- Session timeout
- Role-based access control (RBAC)

### Data Encryption

- **Database**: ‡πÉ‡∏ä‡πâ PostgreSQL encryption at rest
- **Backups**: ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏´‡∏±‡∏™ backup files
- **Connection**: ‡πÉ‡∏ä‡πâ SSL/TLS ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö database connection
- **Credentials**: ‡πÑ‡∏°‡πà‡πÄ‡∏Å‡πá‡∏ö plain text passwords

---

## üêõ Troubleshooting

### Web UI ‡πÑ‡∏°‡πà‡πÇ‡∏´‡∏•‡∏î

```bash
# ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö containers
docker-compose ps

# Restart services
docker-compose restart

# ‡∏î‡∏π logs
docker-compose logs -f web
```

### Database ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ

```bash
# ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö database
docker-compose ps db

# Restart database
docker-compose restart db

# ‡∏ó‡∏î‡∏™‡∏≠‡∏ö connection
docker-compose exec web python -c "from config.database import get_db_config; print(get_db_config())"
```

### Import ‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤

```bash
# ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå
python eclaim_import.py --analyze downloads/file.xls

# ‡∏î‡∏π logs
docker-compose logs -f web

# ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö database schema
docker-compose exec db psql -U eclaim -d eclaim_db -c "\dt"
```

### Scheduler ‡πÑ‡∏°‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô

```bash
# ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö settings
curl http://localhost:5001/api/schedule | python3 -m json.tool

# Restart web service
docker-compose restart web

# ‡∏î‡∏π logs
docker-compose logs -f web | grep scheduler
```

---

## üß™ Sample Statistics

‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏à‡∏£‡∏¥‡∏á:

- **Total Files**: 382 ‡πÑ‡∏ü‡∏•‡πå
- **Total Records**: 40,006 records
- **Total Reimbursement**: ~141.6 million THB

**By Type:**
- **OP**: 252 files, 32,553 records (14.1M THB)
- **IP**: 82 files, 6,217 records (123.6M THB)
- **ORF**: 45 files, 260 records
- **IP_APPEAL_NHSO**: 2 files, 974 records (3.8M THB)
- **IP_APPEAL**: 1 file, 2 records (81K THB)

---

## üìö Documentation

- üê≥ [Docker Setup Guide](DOCKER.md) - Complete Docker documentation
- üíæ [Database Import Guide](database/IMPORT_GUIDE.md) - Import system documentation
- üìä [E-Claim Analysis Report](ECLAIM_ANALYSIS_REPORT.md) - File structure analysis

---

## ü§ù Contributing

Contributions are welcome! Please feel free to submit a Pull Request.

1. Fork the repository
2. Create your feature branch (`git checkout -b feature/AmazingFeature`)
3. Commit your changes (`git commit -m 'Add some AmazingFeature'`)
4. Push to the branch (`git push origin feature/AmazingFeature`)
5. Open a Pull Request

---

## üìù License

MIT License - see [LICENSE](LICENSE) file for details

---

## üôè Acknowledgments

- NHSO E-Claim System
- Flask Framework
- PostgreSQL Database
- APScheduler Library
- Tailwind CSS
- Docker Community

---

## üè∑Ô∏è Version History

### v1.1.0 (2026-01-08)
- ‚ú® Auto Download Scheduling with APScheduler
- ‚ú® Settings Page (Credentials + Schedule Management)
- ‚ú® Pagination & Month/Year Filtering
- ‚ú® Real-time Log Streaming (Server-Sent Events)
- ‚ú® Schedule Status Display
- ‚ú® Auto-Import Toggles
- üê≥ Docker Compose (with/without DB)
- üìö Legal & Compliance Documentation

### v1.0.0 (Initial Release)
- üì• E-Claim Downloader (HTTP Client)
- üåê Web UI Dashboard
- üíæ Database Import System
- üê≥ Docker Support

---

**Made with ‚ù§Ô∏è by [aegisx platform](https://github.com/aegisx-platform)**
