# üì± Usage Guide

## Web UI Overview

Access the web interface at: **http://localhost:5001**

### Main Navigation

- **Dashboard** - ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡πÅ‡∏•‡∏∞‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°
- **Files** - ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà download
- **Download** - ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏î‡∏∑‡∏≠‡∏ô/‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö download
- **Settings** - ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö

---

## 1. Dashboard Page

![Dashboard](../screenshots/dashboard.jpeg)

### Features

- ‡∏î‡∏π‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Å‡∏≤‡∏£ download (Total files, size, last run, file types)
- ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ **Auto Download Schedule** (Active/Inactive)
- ‡πÅ‡∏™‡∏î‡∏á **Next Download Time** ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡∏¥‡∏î scheduler
- ‡∏î‡∏π‡πÑ‡∏ü‡∏•‡πå‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î 5 ‡πÑ‡∏ü‡∏•‡πå
- Real-time updates

### Quick Actions

- **Trigger Manual Download** - ‡πÄ‡∏£‡∏¥‡πà‡∏° download ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
- **View All Files** - ‡πÑ‡∏õ‡∏¢‡∏±‡∏á Files page
- **Configure Settings** - ‡πÑ‡∏õ‡∏¢‡∏±‡∏á Settings page

---

## 2. Files Page

### Features

- ‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (pagination 50 ‡∏ï‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤)
- ‡∏Å‡∏£‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡πÄ‡∏î‡∏∑‡∏≠‡∏ô/‡∏õ‡∏µ (default: ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô)
- ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ import (‚úÖ Imported / ‚è≥ Pending)
- Download ‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÑ‡∏ü‡∏•‡πå
- Import file ‡πÄ‡∏î‡∏µ‡πà‡∏¢‡∏ß ‡∏´‡∏£‡∏∑‡∏≠ Import All
- Delete ‡πÑ‡∏ü‡∏•‡πå

### Month/Year Filter

```
‡πÄ‡∏î‡∏∑‡∏≠‡∏ô: [‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏° ‚ñº] ‡∏õ‡∏µ: [2568 ‚ñº] [Filter]
```

- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÅ‡∏•‡∏∞‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
- ‡∏Å‡∏î "Filter" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á‡∏ô‡∏±‡πâ‡∏ô
- ‡∏Å‡∏î "Clear" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î

### Import Actions

#### Import Single File

```
[‡πÑ‡∏ü‡∏•‡πå] [Import] [Download] [Delete]
```

1. ‡∏Å‡∏î "Import" ‡∏ó‡∏µ‡πà‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
2. ‡∏£‡∏≠ import ‡πÄ‡∏™‡∏£‡πá‡∏à (real-time progress)
3. ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô "‚úÖ Imported"

#### Import All Files

```
[Import All Pending Files]
```

1. ‡∏Å‡∏î "Import All" ‡∏ö‡∏ô‡∏´‡∏ô‡πâ‡∏≤
2. ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞ import ‡∏ó‡∏∏‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà status = Pending
3. ‡∏î‡∏π progress bar ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∑‡∏ö‡∏´‡∏ô‡πâ‡∏≤
4. ‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß‡πÅ‡∏™‡∏î‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà import ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à

### Delete Files

```
[Delete] button ‡∏Ç‡πâ‡∏≤‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÑ‡∏ü‡∏•‡πå
```

1. ‡∏Å‡∏î "Delete"
2. ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö (confirmation dialog)
3. ‡πÑ‡∏ü‡∏•‡πå‡∏ñ‡∏π‡∏Å‡∏•‡∏ö‡∏à‡∏≤‡∏Å‡∏ó‡∏±‡πâ‡∏á disk ‡πÅ‡∏•‡∏∞ database

---

## 3. Download Configuration Page

### Single Month Download

```
‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏î‡∏∑‡∏≠‡∏ô: [‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏° ‚ñº]
‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏µ: [2568 ‚ñº]
‚òê Auto-import after download
[Download This Month]
```

**Steps:**
1. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å month ‡πÅ‡∏•‡∏∞ year
2. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å "Auto-import" ‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ import ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
3. ‡∏Å‡∏î "Download This Month"
4. ‡∏£‡∏≠ download ‡πÄ‡∏™‡∏£‡πá‡∏à

**Use Case:** Download ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏û‡∏•‡∏≤‡∏î‡πÑ‡∏õ

### Bulk Download (Date Range)

```
Start Date: [‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏° ‚ñº] [2568 ‚ñº]
End Date: [‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏° ‚ñº] [2568 ‚ñº]
‚òê Auto-import after download
[Download All Months]
```

**Steps:**
1. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å start month/year
2. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å end month/year
3. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å "Auto-import" ‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
4. ‡∏Å‡∏î "Download All Months"
5. ‡∏î‡∏π progress bar (‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏•‡∏±‡∏á download)

**Estimated Time:**
- ~30-60 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ‡∏ï‡πà‡∏≠‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
- 12 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‚âà 6-12 ‡∏ô‡∏≤‡∏ó‡∏µ

**Use Case:** Download ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏õ‡∏µ

### Progress Display

```
Downloading: [‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà] 5/12 months
Current: December 2568
Files downloaded: 23 files
```

- ‡πÅ‡∏™‡∏î‡∏á progress bar
- ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏•‡∏±‡∏á download
- ‡πÅ‡∏™‡∏î‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÑ‡∏ü‡∏•‡πå

---

## 4. Settings Page

### E-Claim Credentials

```
Username: [_______________]
Password: [_______________]
[Save Credentials]
```

**Steps:**
1. ‡πÉ‡∏™‡πà username ‡πÅ‡∏•‡∏∞ password ‡∏à‡∏≤‡∏Å NHSO
2. ‡∏Å‡∏î "Save Credentials"
3. ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ñ‡∏π‡∏Å‡πÄ‡∏Å‡πá‡∏ö‡πÉ‡∏ô `config/settings.json`

### Auto Download Schedule

```
‚òë Enable Schedule

Scheduled Times:
‚Ä¢ 09:00 [Remove]
‚Ä¢ 20:00 [Remove]

[Add Schedule] Time: [HH:MM]

‚òë Auto-import files after scheduled download

[Save Schedule] [Test Run Now]
```

**Setup Scheduler:**
1. ‡∏Å‡∏î **"Add Schedule"** ‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏ß‡∏•‡∏≤ (‡πÄ‡∏ä‡πà‡∏ô 09:00)
2. ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ß‡∏•‡∏≤‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡πÑ‡∏î‡πâ (‡πÄ‡∏ä‡πà‡∏ô 14:00, 20:00)
3. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å **"Auto-import"** ‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
4. ‡πÄ‡∏õ‡∏¥‡∏î **"Enable Schedule"** toggle
5. ‡∏Å‡∏î **"Save Schedule"**

**Example:** ‡∏ï‡∏±‡πâ‡∏á‡πÉ‡∏´‡πâ download ‡∏ß‡∏±‡∏ô‡∏•‡∏∞ 3 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á
- 09:00 ‡∏ô. - download ‡πÄ‡∏ä‡πâ‡∏≤
- 14:00 ‡∏ô. - download ‡∏ö‡πà‡∏≤‡∏¢
- 20:00 ‡∏ô. - download ‡πÄ‡∏¢‡πá‡∏ô

**Test Run:**
- ‡∏Å‡∏î **"Test Run Now"** ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
- ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏≠‡∏ñ‡∏∂‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á‡πÑ‡∏ß‡πâ

---

## ‚è∞ Using Auto Download Schedule

### Scheduler Overview

Scheduler ‡∏à‡∏∞ download ‡πÑ‡∏ü‡∏•‡πå e-claim ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏ï‡∏≤‡∏°‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á‡πÑ‡∏ß‡πâ

### How It Works

1. **Background Service** - ‡∏£‡∏±‡∏ô‡πÉ‡∏ô background
2. **Daily Execution** - download ‡∏ï‡∏≤‡∏°‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á
3. **Auto-Import** - import ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡∏¥‡∏î‡πÑ‡∏ß‡πâ
4. **Duplicate Prevention** - ‡πÑ‡∏°‡πà download ‡∏ã‡πâ‡∏≥

### Schedule Status Display

#### Dashboard Page

```
üìÖ Auto Download Schedule: Active
‚è∞ Next Download: Today at 20:00
```

#### Files Page

```
‚ÑπÔ∏è Auto Download is ACTIVE - Next run: Today at 20:00
```

### Checking Schedule Status

```bash
# API endpoint
curl http://localhost:5001/api/schedule
```

Response:
```json
{
  "enabled": true,
  "times": [
    {"hour": 9, "minute": 0},
    {"hour": 20, "minute": 0}
  ],
  "auto_import": true,
  "next_run_time": "2026-01-08T20:00:00"
}
```

### Managing Schedule

**Enable/Disable:**
- Settings page ‚Üí Toggle "Enable Schedule"
- ‡∏Å‡∏î "Save Schedule"

**Add Time:**
- Settings page ‚Üí "Add Schedule"
- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ß‡∏•‡∏≤ ‚Üí ‡∏Å‡∏î "Add"

**Remove Time:**
- Settings page ‚Üí ‡∏Å‡∏î "Remove" ‡∏Ç‡πâ‡∏≤‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö

**Test Immediately:**
- Settings page ‚Üí ‡∏Å‡∏î "Test Run Now"

### Troubleshooting Scheduler

**Scheduler ‡πÑ‡∏°‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô:**
```bash
# ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö logs
docker-compose logs -f web | grep scheduler

# Restart service
docker-compose restart web
```

**‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏ß‡∏•‡∏≤‡πÅ‡∏•‡πâ‡∏ß‡πÑ‡∏°‡πà update:**
- ‡πÉ‡∏´‡πâ restart web service
```bash
docker-compose restart web
```

---

## üìã Real-time Log Viewer

### Viewing Logs

**Web UI:**
- ‡∏Å‡∏î "View Logs" button ‡∏ó‡∏µ‡πà Dashboard ‡∏´‡∏£‡∏∑‡∏≠ Files page
- Real-time streaming (Server-Sent Events)

**Docker:**
```bash
# View all logs
docker-compose logs -f

# View web logs only
docker-compose logs -f web

# View last 100 lines
docker-compose logs --tail=100 web
```

### Log Files

```
logs/
‚îú‚îÄ‚îÄ downloader.log      # Download logs
‚îú‚îÄ‚îÄ import.log          # Import logs
‚îî‚îÄ‚îÄ app.log             # Application logs
```

---

## üîÑ Import System

### Import Process

1. **Parse Excel** - ‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå .xls
2. **Extract Data** - ‡πÅ‡∏¢‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏° columns
3. **Transform** - ‡πÅ‡∏õ‡∏•‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà, ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
4. **Load** - import ‡πÄ‡∏Ç‡πâ‡∏≤ database (UPSERT)
5. **Track Status** - ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞

### Import Status

- ‚úÖ **Imported** - import ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß
- ‚è≥ **Pending** - ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ import
- ‚ùå **Failed** - import ‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à

### Re-import Files

‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ import ‡∏ã‡πâ‡∏≥:

```bash
# ‡∏•‡∏ö tracking record
docker-compose exec db psql -U eclaim -d eclaim_db -c \
  "DELETE FROM eclaim_imported_files WHERE filename = 'your_file.xls';"

# Import ‡πÉ‡∏´‡∏°‡πà
docker-compose exec web python eclaim_import.py downloads/your_file.xls
```

---

## üéØ Best Practices

### Daily Operations

1. **Check Dashboard** ‡∏ó‡∏∏‡∏Å‡πÄ‡∏ä‡πâ‡∏≤
   - ‡∏î‡∏π‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ scheduler
   - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏´‡∏°‡πà

2. **Review Import Status** ‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏•‡∏∞‡∏Ñ‡∏£‡∏±‡πâ‡∏á
   - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö pending files
   - Import ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏Ñ‡πâ‡∏≤‡∏á‡∏≠‡∏¢‡∏π‡πà

3. **Monitor Logs** ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤
   - ‡∏î‡∏π error messages
   - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö download/import failures

### Monthly Tasks

1. **Backup Database**
   ```bash
   docker-compose exec db pg_dump -U eclaim eclaim_db > backup_$(date +%Y%m).sql
   ```

2. **Review Statistics**
   - ‡∏î‡∏π‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
   - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á

3. **Clean Old Files** (optional)
   ```bash
   # Keep only last 3 months
   find downloads/ -name "*.xls" -mtime +90 -delete
   ```

---

**[‚Üê Back: Configuration](CONFIGURATION.md)** | **[Next: Database Guide ‚Üí](DATABASE.md)**
